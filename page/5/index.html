<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Inhwan&#039;s Digital Space</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Inhwan&#039;s Digital Space"><meta name="msapplication-TileImage" content="/img/favicon-32x32.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Inhwan&#039;s Digital Space"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="I&amp;#39;m Learning ML&amp;#x2F;DL"><meta property="og:type" content="blog"><meta property="og:title" content="Inhwan&#039;s Digital Space"><meta property="og:url" content="http://inhwancho.github.io/"><meta property="og:site_name" content="Inhwan&#039;s Digital Space"><meta property="og:description" content="I&amp;#39;m Learning ML&amp;#x2F;DL"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://inhwancho.github.io/img/og_image.png"><meta property="article:author" content="InhwanCho"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://inhwancho.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://InhwanCho.github.io"},"headline":"Inhwan's Digital Space","image":["http://inhwancho.github.io/img/og_image.png"],"author":{"@type":"Person","name":"InhwanCho"},"publisher":{"@type":"Organization","name":"Inhwan's Digital Space","logo":{"@type":"ImageObject","url":"http://inhwancho.github.io/img/yo_img.jpg"}},"description":"I&#39;m Learning ML&#x2F;DL"}</script><link rel="icon" href="/img/favicon-32x32.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles//css/stackoverflow-dark.css.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-8RGKYVDD5B" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-8RGKYVDD5B');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="Inhwan's Digital Space" type="application/rss+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/yo_img.jpg" alt="Inhwan&#039;s Digital Space" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/InhwanCho"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-19T15:00:00.000Z" title="2022. 12. 20. 오전 12:00:00">2022-12-20</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-19T15:00:00.000Z" title="2022. 12. 20. 오전 12:00:00">2022-12-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">3 minutes read (About 432 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/20/Study_folder/DL(Deep_Learning)/2022-12-20-loss/">Keras 손실(loss) 함수 종류</a></h1><div class="content"><h2 id="손실-함수"><a href="#손실-함수" class="headerlink" title="손실 함수"></a>손실 함수</h2><ul>
<li><p>손실 함수란?<br>손실 함수는 값을 예측하려할 때 데이터에대한 예측값과 실제의 값을 비교하는 함수로 모델을 훈련시킬 때 오류를 최소화 시키기 위해 사용되는 함수이다.<br>모델의 성능을 올리기 위해 loss 함수를 임의적으로 변형할 수 있다.</p>
</li>
<li><p>딥러닝에서 손실 함수는 여러가지 말로 표현됩니다.</p>
</li>
</ul>
<p><code>비용 함수(cost function) = 손실 함수(loss function) = 오차 함수(error function) = 목적 함수(objective function)</code></p>
<h2 id="Mean-Squared-error"><a href="#Mean-Squared-error" class="headerlink" title="Mean_Squared_error"></a>Mean_Squared_error</h2><ul>
<li>예측한 값과 실제 값 사이의 평균 제곱 오차를 정의한다. 공식이 매우 간단하며, 차가 커질수록 제곱 연산으로 인해서 값이 더욱 뚜렷해진다.<br>그리고 제곱으로 인해서 오차가 양수이든 음수이든 누적 값을 증가시킨다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line">MSE = mean_squared_error(y, y_pred)</span><br></pre></td></tr></table></figure>

<h2 id="RMSE-Root-Mean-Squared-error"><a href="#RMSE-Root-Mean-Squared-error" class="headerlink" title="RMSE(Root Mean Squared error)"></a>RMSE(Root Mean Squared error)</h2><ul>
<li>Mean_Squared_error에 Root를 씌운 값으로 왜곡을 줄여준다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line">RMSE = mean_squared_error(y, y_pred)**<span class="number">0.5</span></span><br><span class="line">RMSE = mean_squared_error(y, y_pred, squared=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h2 id="RMSLE-Root-mean-squared-Logarithmic-error"><a href="#RMSLE-Root-mean-squared-Logarithmic-error" class="headerlink" title="RMSLE(Root mean squared Logarithmic error)"></a>RMSLE(Root mean squared Logarithmic error)</h2><ul>
<li>중간에 로그를 취해서 편차를 구함</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_log_error</span><br><span class="line"></span><br><span class="line">MSLE = mean_squared_log_error(y, y_pred)</span><br><span class="line">RMSLE = mean_squared_log_error(y, y_pred)**<span class="number">0.5</span></span><br></pre></td></tr></table></figure>

<h2 id="Binary-Crossentropy"><a href="#Binary-Crossentropy" class="headerlink" title="Binary Crossentropy"></a>Binary Crossentropy</h2><ul>
<li>이진 분류(0또는 1분류)를 할 경우 사용.</li>
</ul>
<h2 id="sparse-categorical-crossentropy-vs-categorical-crossentropy"><a href="#sparse-categorical-crossentropy-vs-categorical-crossentropy" class="headerlink" title="sparse_categorical_crossentropy vs categorical_crossentropy"></a>sparse_categorical_crossentropy vs categorical_crossentropy</h2><ul>
<li><p>모두 다중 분류 손실 함수이다.</p>
</li>
<li><p>categorical_crossentropy는 다중 분류 손실 함수로 one_hot_encoding 클래스이다</p>
</li>
<li><p>sparse_categorical_crossentropy는 int_type 클래스이다.</p>
</li>
<li><p>결론적으로, 원핫백터인 경우 <code>categorical_crossentropy</code><br><br>int인 경우에는 <code>sparse_categorical_crossentropy</code>를 사용하면 된다.</p>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-19T15:00:00.000Z" title="2022. 12. 20. 오전 12:00:00">2022-12-20</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-19T15:00:00.000Z" title="2022. 12. 20. 오전 12:00:00">2022-12-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">5 minutes read (About 814 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/20/Study_folder/TensorFlow/2022-12-20-DCGAN/">DCGAN(DC 생산적 적대 신경망)</a></h1><div class="content"><h2 id="Deep-Convolutional-GAN-Generative-Adversarial-Nets"><a href="#Deep-Convolutional-GAN-Generative-Adversarial-Nets" class="headerlink" title="Deep Convolutional GAN(Generative Adversarial Nets)"></a>Deep Convolutional GAN(Generative Adversarial Nets)</h2><ul>
<li>GAN 모델은 ‘생성자 모델 G’(Generator)와 ‘판독자 모델 D’(Discriminator)을 만들고</li>
<li>D와 G의 경찰과 도둑 게임하는 형식으로 이미지 생성하는 방식이다.</li>
<li>그렇기 때문에 2가지 모델을 생성해야 한다.</li>
<li>G모델이 이미지를 생성하고 그 이미지의 판독 결과가 0.5(진짜도 가짜도 아닌)될 때까지 학습시켜 이미지 생성</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Input, Dense, Reshape,Flatten, Dropout</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> BatchNormalization, Activation, LeakyReLU, UpSampling2D, Conv2D</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential, Model</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment">##### 모델 G(생성자) #####</span></span><br><span class="line">generator = Sequential()</span><br><span class="line"></span><br><span class="line">generator.add(Dense(<span class="number">128</span>*<span class="number">7</span>*<span class="number">7</span> ,input_dim = <span class="number">100</span> , activation = LeakyReLU(<span class="number">0.2</span>))) </span><br><span class="line">generator.add(BatchNormalization())</span><br><span class="line"><span class="comment"># 128은 임의의 수를 입력</span></span><br><span class="line"><span class="comment"># 7*7은 나중에 *2 and *2를 해서 28을 맞추게 될 기초 값</span></span><br><span class="line"><span class="comment"># 28*28로 (mnist 이미지가 28*28이기 때문) </span></span><br><span class="line"><span class="comment"># LeakyReLU 뒤의 값은 음수일때의 기울기 값이며 보통 0.1을 입력</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#upsampling시 이미지 크기가 2배가 됨</span></span><br><span class="line">generator.add(Reshape((<span class="number">7</span>,<span class="number">7</span>,<span class="number">128</span>)))<span class="comment"># Conv2D가 받을 수있는 구조로 변경</span></span><br><span class="line">generator.add(UpSampling2D()) <span class="comment"># 14,14,128</span></span><br><span class="line"></span><br><span class="line">generator.add(Conv2D(<span class="number">64</span>, kernel_size =<span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">generator.add(BatchNormalization())</span><br><span class="line">generator.add(Activation(LeakyReLU(<span class="number">0.2</span>)))</span><br><span class="line">generator.add(UpSampling2D())<span class="comment"># 28,28,64</span></span><br><span class="line"></span><br><span class="line">generator.add(Conv2D(<span class="number">1</span>, kernel_size = <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>, activation=<span class="string">&#x27;tanh&#x27;</span>)) <span class="comment">#28,28,1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##### 모델 D(판독자) #####</span></span><br><span class="line">discriminator = Sequential()</span><br><span class="line"></span><br><span class="line">discriminator.add(Conv2D(<span class="number">64</span>, kernel_size=<span class="number">5</span>, strides=<span class="number">2</span>, input_shape=(<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>), padding=<span class="string">&quot;same&quot;</span>))</span><br><span class="line">discriminator.add(Activation(LeakyReLU(<span class="number">0.2</span>)))</span><br><span class="line">discriminator.add(Dropout(<span class="number">0.3</span>))</span><br><span class="line"></span><br><span class="line">discriminator.add(Conv2D(<span class="number">128</span>, kernel_size=<span class="number">5</span>, strides=<span class="number">2</span>, padding=<span class="string">&quot;same&quot;</span>))</span><br><span class="line">discriminator.add(Activation(LeakyReLU(<span class="number">0.2</span>)))</span><br><span class="line">discriminator.add(Dropout(<span class="number">0.3</span>))</span><br><span class="line">discriminator.add(Flatten())</span><br><span class="line">discriminator.add(Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line"></span><br><span class="line">discriminator.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=<span class="string">&#x27;adam&#x27;</span>)</span><br><span class="line">discriminator.trainable = <span class="literal">False</span> <span class="comment">#판별자, 학습 가능 여부 = False #가장 중요한 문구!</span></span><br><span class="line"><span class="comment">#####</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#G모델의 input_dim이 100이기에 그에 맞춰야함</span></span><br><span class="line">g_input = Input(shape=(<span class="number">100</span>,))</span><br><span class="line">dis_output = discriminator(generator(g_input))</span><br><span class="line">gan = Model(g_input, dis_output)</span><br><span class="line">gan.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer = <span class="string">&#x27;adam&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##### 트레인 함수 생성, train_on_batch로 학습 #####</span></span><br><span class="line"><span class="comment"># gan_train(2001,32,200)을 사용할 예정</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gan_train</span>(<span class="params">epoch, batch_size, saving_interval</span>):</span><br><span class="line"></span><br><span class="line">  (X_train, _), (_, _) = mnist.load_data() <span class="comment">#gan에서는 타겟,vailidation이 필요없어서 X_train만 저장</span></span><br><span class="line">  X_train = X_train.reshape(X_train.shape[<span class="number">0</span>],<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">  <span class="comment"># print(X_train.shape[0])</span></span><br><span class="line">  X_train = (X_train - <span class="number">127.5</span>) / <span class="number">127.5</span> <span class="comment">#-1 ~ +1로 스케일링</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  real = np.ones((batch_size,<span class="number">1</span>)) <span class="comment">#실제 이미지는 모두 참이므로 1로 초기화 </span></span><br><span class="line">  fake = np.zeros((batch_size,<span class="number">1</span>)) <span class="comment">#32개(batch_size)의 가짜 이미지는 0으로 초기화</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">    <span class="comment">#실제 이미지를 판별자에 입력하는 부분</span></span><br><span class="line">    idx = np.random.randint(<span class="number">0</span>,X_train.shape[<span class="number">0</span>], batch_size)</span><br><span class="line">    imgs = X_train[idx]</span><br><span class="line">    d_loss_real = discriminator.train_on_batch(imgs, real)<span class="comment">#train_on_batch(실제 이미지, 레이블(==1))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#가짜 이미지를 판별자에 입력하는 부분</span></span><br><span class="line">    noise = np.random.normal(<span class="number">0</span>,<span class="number">1</span>, (batch_size, <span class="number">100</span>))</span><br><span class="line">    gen_imgs = generator.predict(noise)</span><br><span class="line">    d_loss_fake = discriminator.train_on_batch(gen_imgs, fake)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#판별자와 생성자의 오차를 계산</span></span><br><span class="line">    </span><br><span class="line">    d_loss = <span class="number">0.5</span> * np.add(d_loss_real, d_loss_fake) <span class="comment">#판별자의 오차</span></span><br><span class="line"></span><br><span class="line">    g_loss = gan.train_on_batch(noise, real) <span class="comment">#생성자의 오차, 진짜라고 속여야되서 real을 줌(생성자에서 레이블을 1(ones)으로 설정해서 판별자로 전달)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;epoch: <span class="subst">&#123;i&#125;</span>, d_loss:<span class="subst">&#123;d_loss:<span class="number">.4</span>f&#125;</span>, g_loss: <span class="subst">&#123;g_loss:<span class="number">.4</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i % saving_interval == <span class="number">0</span>:</span><br><span class="line">        <span class="comment">#r, c = 5, 5</span></span><br><span class="line">        noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">25</span>, <span class="number">100</span>))</span><br><span class="line">        gen_imgs = generator.predict(noise)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Rescale images 0 - 1</span></span><br><span class="line">        gen_imgs = <span class="number">0.5</span> * gen_imgs + <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">        fig, axs = plt.subplots(<span class="number">5</span>, <span class="number">5</span>)</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                axs[j, k].imshow(gen_imgs[count, :, :, <span class="number">0</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">                axs[j, k].axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">        fig.savefig(<span class="string">f&#x27;./gan_mnist_<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">gan_train(<span class="number">2001</span>,<span class="number">32</span>,<span class="number">200</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>기존의 이미지가 아닌 가짜의 이미지가 생성됩니다.(숫자지만 숫자 아닌듯한 느낌?)</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/111936229/209415464-6e38c063-7300-4385-902a-71d853b785a4.png" alt="gan_mnist_2000"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-18T15:00:00.000Z" title="2022. 12. 19. 오전 12:00:00">2022-12-19</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-22T15:00:00.000Z" title="2022. 12. 23. 오전 12:00:00">2022-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/Project/">Project</a></span><span class="level-item">4 minutes read (About 654 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/19/Portfolio/2022-12-19-img-webcrawling/">미니프로젝트 part 1</a></h1><div class="content"><h2 id="google-image-save-using-Chrome-driver"><a href="#google-image-save-using-Chrome-driver" class="headerlink" title="google image save using Chrome driver"></a>google image save using Chrome driver</h2><ul>
<li>이번 미니 프로젝트의 목표는<ul>
<li><code>구글 이미지를 웹크롤링을 이용하여 이미지 저장</code> -&gt;</li>
</ul>
</li>
<li>이미지 분류 모델(Swin Transformer모델을 이용한 파인 튜닝) -&gt; </li>
<li>모델 불러오기 + 구글 이미지를 분류 &amp; 삭제(+정렬)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen, urlparse, urlunparse, urlretrieve</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> tqdm.notebook <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">chrome_path =<span class="string">&#x27;../Desktop/chromedriver&#x27;</span>      <span class="comment">#크롬드라이버 경로(각자 환경에 맞춰 수정)</span></span><br><span class="line"></span><br><span class="line">chrome_options = webdriver.ChromeOptions()</span><br><span class="line">chrome_options.add_argument(<span class="string">&quot;lang=ko_KR&quot;</span>) <span class="comment"># 한국어</span></span><br><span class="line">chrome_options.add_argument(<span class="string">&#x27;window-size=1920x1080&#x27;</span>) <span class="comment">#윈도우 창크기를 키움</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">selenium_scroll_option</span>():</span><br><span class="line">    <span class="comment"># 스크롤 높이 가져옴</span></span><br><span class="line">    last_height = driver.execute_script(<span class="string">&#x27;return document.body.scrollHeight&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 끝까지 스크롤 다운</span></span><br><span class="line">        driver.execute_script(<span class="string">&#x27;window.scrollTo(0, document.body.scrollHeight);&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="comment"># 스크롤 다운 후 스크롤 높이 다시 가져옴</span></span><br><span class="line">        new_height = driver.execute_script(<span class="string">&#x27;return document.body.scrollHeight&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> new_height == last_height:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        last_height = new_height</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 키워드 검색하기</span></span><br><span class="line">keyword = <span class="built_in">input</span>(<span class="string">&quot;검색할 키워드를 입력 : &quot;</span>)</span><br><span class="line">image_name = <span class="built_in">input</span>(<span class="string">&quot;저장할 이미지(+폴더) 이름 : &quot;</span>)</span><br><span class="line"><span class="comment">#폴더가 없으면 폴더 생성</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">f&#x27;./<span class="subst">&#123;image_name&#125;</span>&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;create directory ... <span class="subst">&#123;image_name&#125;</span>&#x27;</span>)</span><br><span class="line">    os.mkdir(<span class="string">f&#x27;./<span class="subst">&#123;image_name&#125;</span>&#x27;</span>)</span><br><span class="line">driver = webdriver.Chrome(chrome_path)</span><br><span class="line">driver.get(<span class="string">&#x27;http://www.google.co.kr/imghp?hl=ko&#x27;</span>)</span><br><span class="line">browser = driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;body &gt; div.L3eUgb &gt; div.o3j99.ikrT4e.om7nvf &gt; form </span></span><br><span class="line"><span class="string">                              &gt; div:nth-child(1) &gt; div.A8SBwf &gt; div.RNNXgb &gt; div &gt; div.a4bIc &gt; input&#x27;</span> )</span><br><span class="line">browser.click()</span><br><span class="line">browser.send_keys(keyword)</span><br><span class="line">browser.send_keys(Keys.RETURN)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###### 이 부분의 bb함수 부분은 &#x27;검색 결과 더보기&#x27;버튼을 누르는 함수인데 버전마다 차이가 있으니 수정해서 사용해야됩니다. 본인은 mac/ 4.6.0 사용</span></span><br><span class="line">selenium_scroll_option() <span class="comment"># 스크롤하여 이미지를 많이 확보</span></span><br><span class="line">bb = driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#islmp &gt; div &gt; div &gt; div &gt; div &gt; div.gBPM8 &gt; div.qvfT1 &gt; div.YstHxe &gt; input&#x27;</span>)</span><br><span class="line">bb.click() <span class="comment"># 이미지 더보기 클릭</span></span><br><span class="line">selenium_scroll_option()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#이미지 src요소를 리스트업해서 이미지 url 저장</span></span><br><span class="line">images = driver.find_elements(By.CSS_SELECTOR, <span class="string">&quot;.rg_i.Q4LuWd&quot;</span>) <span class="comment"># 클래스 네임에서 공백은 .을 찍어줌</span></span><br><span class="line"></span><br><span class="line">images_url = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> images: </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i.get_attribute(<span class="string">&#x27;src&#x27;</span>)!= <span class="literal">None</span> :</span><br><span class="line">        images_url.append(i.get_attribute(<span class="string">&#x27;src&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        images_url.append(i.get_attribute(<span class="string">&#x27;data-src&#x27;</span>))</span><br><span class="line"><span class="comment"># driver.close()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 겹치는 이미지 url 제거</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;전체 다운로드한 이미지 개수: &#123;&#125;\n동일한 이미지를 제거한 이미지 개수: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(images_url), <span class="built_in">len</span>(pd.DataFrame(images_url)[<span class="number">0</span>].unique())))</span><br><span class="line">images_url=pd.DataFrame(images_url)[<span class="number">0</span>].unique()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 저장</span></span><br><span class="line"><span class="comment"># 저장되는 규칙은 folder_name(경로)/이미지 이름(크롤링 시 폴더 생성 input 이름)_번호.jpg</span></span><br><span class="line">folder_name = (<span class="string">f&#x27;./<span class="subst">&#123;image_name&#125;</span>/&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i, url <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(images_url), <span class="number">0</span>): </span><br><span class="line">    urlretrieve(url, folder_name + image_name + <span class="string">&#x27;_&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line">driver.close()</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-18T15:00:00.000Z" title="2022. 12. 19. 오전 12:00:00">2022-12-19</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-18T15:00:00.000Z" title="2022. 12. 19. 오전 12:00:00">2022-12-19</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">2 minutes read (About 364 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/19/Study_folder/Pytorch/2022-12-19-methods-of-torch/">파이토치 함수</a></h1><div class="content"><h2 id="ones-zeros"><a href="#ones-zeros" class="headerlink" title="ones(),zeros()"></a>ones(),zeros()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">torch.zeros(<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line"><span class="comment"># tensor([[0., 0., 0., 0.],</span></span><br><span class="line"><span class="comment">#         [0., 0., 0., 0.],</span></span><br><span class="line"><span class="comment">#         [0., 0., 0., 0.],</span></span><br><span class="line"><span class="comment">#         [0., 0., 0., 0.]])</span></span><br><span class="line">tensor = torch.ones(<span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"><span class="comment"># tensor([[1., 1., 1., 1.],</span></span><br><span class="line"><span class="comment">#         [1., 1., 1., 1.],</span></span><br><span class="line"><span class="comment">#         [1., 1., 1., 1.],</span></span><br><span class="line"><span class="comment">#         [1., 1., 1., 1.]])</span></span><br><span class="line"><span class="comment">#슬라이싱도 가능</span></span><br><span class="line">tensor[:,<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(tensor)</span><br><span class="line">tensor([[<span class="number">1.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">1.</span>]])</span><br></pre></td></tr></table></figure>

<h2 id="cat"><a href="#cat" class="headerlink" title="cat()"></a>cat()</h2><ul>
<li>판다스의 concat()함수와 마찬가지로 리스트로 만들어줘야한다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tensor = torch.ones(<span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line">tensor[:,<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">con_tensor = torch.cat([tensor, tensor, tensor], dim=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(con_tensor)</span><br><span class="line"><span class="comment"># tensor([[1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],</span></span><br><span class="line"><span class="comment">#         [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],</span></span><br><span class="line"><span class="comment">#         [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],</span></span><br><span class="line"><span class="comment">#         [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.]])</span></span><br></pre></td></tr></table></figure>

<h2 id="argmax"><a href="#argmax" class="headerlink" title="argmax()"></a>argmax()</h2><ul>
<li>최대값의 index를 찾아주는 함수</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># dim 옵션이 없을 경우(default)</span></span><br><span class="line">a = torch.randn(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">argmax = torch.argmax(a)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(argmax)</span><br><span class="line"><span class="comment"># tensor([[-0.0626, -1.4816, -0.6745],</span></span><br><span class="line"><span class="comment">#         [-0.8330,  0.2181,  0.5294],</span></span><br><span class="line"><span class="comment">#         [ 0.3596, -0.5217,  0.0292]])</span></span><br><span class="line"><span class="comment"># tensor(5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#dim option을 줄 경우</span></span><br><span class="line"></span><br><span class="line">a = torch.randn(<span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">argmax_dim_0 = torch.argmax(a, dim = <span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(argmax_dim_0)</span><br><span class="line"><span class="comment"># tensor([[ 2.1830,  0.1679, -0.7654],</span></span><br><span class="line"><span class="comment">#         [-0.4077,  0.1342, -0.3766],</span></span><br><span class="line"><span class="comment">#         [-0.9798,  1.2932, -0.4124]])</span></span><br><span class="line"><span class="comment"># tensor([0, 2, 1])</span></span><br></pre></td></tr></table></figure>


<h2 id="max"><a href="#max" class="headerlink" title="max()"></a>max()</h2><ul>
<li>최대값을 출력해주는 함수</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = torch.randn(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">justmax = torch.<span class="built_in">max</span>(a)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(argmax)</span><br><span class="line"><span class="comment"># tensor([[ 2.1830,  0.1679, -0.7654],</span></span><br><span class="line"><span class="comment">#         [-0.4077,  0.1342, -0.3766],</span></span><br><span class="line"><span class="comment">#         [-0.9798,  1.2932, -0.4124]])</span></span><br><span class="line"><span class="comment"># tensor(2.1830)</span></span><br></pre></td></tr></table></figure>


<h2 id="item"><a href="#item" class="headerlink" title="item()"></a>item()</h2><ul>
<li>item()은 값만을 가져오고 싶을 경우 사용한다.(scalars에서만 사용 가능)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tensor = torch.ones(<span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">agg = tensor.<span class="built_in">sum</span>()</span><br><span class="line">agg_item = agg.item()</span><br><span class="line"><span class="built_in">print</span>(agg,agg_item, <span class="built_in">type</span>(agg_item))</span><br><span class="line"><span class="comment"># tensor(16.) </span></span><br><span class="line"><span class="comment"># 16.0 </span></span><br><span class="line"><span class="comment"># &lt;class &#x27;float&#x27;&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h2><ul>
<li>eval()은 보통 evaluation 과정 전에 사용되는 함수이다.</li>
<li>eval() 함수는 evaluation 과정에서 사용하지 않아야 하는 layer들을 알아서 off 시키도록 하는 함수이다.</li>
<li>evaluation&#x2F;validation 과정에선 보통 model.eval()과 torch.no_grad()를 함께 사용한다고 한다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">score = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i, (images, labels) <span class="keyword">in</span> <span class="built_in">enumerate</span>(val_loader):</span><br><span class="line">    images = images.to(device)</span><br><span class="line">    labels = labels.to(device)</span><br><span class="line"></span><br><span class="line">    g_labels = model(images)</span><br><span class="line"></span><br><span class="line">    score += <span class="built_in">int</span>(torch.<span class="built_in">max</span>(g_labels, <span class="number">1</span>)[<span class="number">1</span>][<span class="number">0</span>] == labels[<span class="number">0</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="numpy-clip-CV에서-자주-사용됨"><a href="#numpy-clip-CV에서-자주-사용됨" class="headerlink" title="numpy.clip() -CV에서 자주 사용됨"></a>numpy.clip() -CV에서 자주 사용됨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">numpy.clip(array, <span class="built_in">min</span>, <span class="built_in">max</span>)</span><br><span class="line"></span><br><span class="line">    array 내의 값들에 대해서</span><br><span class="line"></span><br><span class="line">    <span class="built_in">min</span> 값 보다 작은 값들을 <span class="built_in">min</span>값으로 바꿔주고</span><br><span class="line"></span><br><span class="line">    <span class="built_in">max</span> 값 보다 큰 값들을 <span class="built_in">max</span>값으로 바꿔주는 함수.</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-17T15:00:00.000Z" title="2022. 12. 18. 오전 12:00:00">2022-12-18</time></span><span class="level-item">Updated&nbsp;<time datetime="2023-01-12T15:00:00.000Z" title="2023. 1. 13. 오전 12:00:00">2023-01-13</time></span><span class="level-item"><a class="link-muted" href="/categories/Errors/">Errors</a></span><span class="level-item">2 minutes read (About 345 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/18/Error_fix/2022-12-18-error-logs/">python error logs</a></h1><div class="content"><h2 id="파이썬-error-log"><a href="#파이썬-error-log" class="headerlink" title="파이썬 error log"></a>파이썬 error log</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AttributeError: Can<span class="string">&#x27;t get attribute &#x27;</span>Sports_Dataset<span class="string">&#x27; on &lt;module &#x27;</span>__main__<span class="string">&#x27; (built-in)&gt;</span></span><br><span class="line"><span class="string"># 파이토치의 torch.utils.data.DataLoader를 불러올때 옵션에 num_workers의 옵션을 ipykenel파일로 실행 하게 될 경우 오류가 난다.</span></span><br><span class="line"><span class="string"># 코랩 환경에서 돌리거나 num_workers옵션을 제거하면 실행은 된다(느리다)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ValueError: <span class="string">&#x27;a&#x27;</span> cannot be empty unless no samples are taken</span><br><span class="line"><span class="comment"># random.choice(range(train_data.__len__())) 이런 명령어를 수행 시 오류</span></span><br><span class="line"><span class="comment"># print(train_data.__len__())하면 0값이 나올것이다. 클래스 또는 함수에서 오타를 수정해보자</span></span><br></pre></td></tr></table></figure>

<h2 id="openCV-error-log"><a href="#openCV-error-log" class="headerlink" title="openCV error log"></a>openCV error log</h2><ul>
<li>opencv는 맥에서 4.xx버전에서는 trackbar기능을 사용 시 에러가 나는 경우가 있습니다.</li>
<li>방법을 찾아봤지만 아직 오류 해결중 인듯으로 보이네요.</li>
<li>찾아본 유일한 해결책은 다운그레이드 (23-01-13기준)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># conda 환경 설정 후에 진행하셔도 됩니다.</span><br><span class="line"># opencv 제거</span><br><span class="line">python -m pip uninstall opencv-python</span><br><span class="line"></span><br><span class="line"># pip upgrade(이거 안하면 에러 나올 확률 있음)</span><br><span class="line">python -m pip install --upgrade pip</span><br><span class="line"></span><br><span class="line"># opencv를 다운 그레이드하기</span><br><span class="line">python -m pip install opencv-python==3.4.14.51</span><br></pre></td></tr></table></figure>

<ul>
<li>실행하여 잘 되는지 확인!</li>
</ul>
<h2 id="openCV의-findContours에서-해당-에러-발생-시"><a href="#openCV의-findContours에서-해당-에러-발생-시" class="headerlink" title="openCV의 findContours에서 해당 에러 발생 시"></a>openCV의 findContours에서 해당 에러 발생 시</h2><ul>
<li>ValueError: too many values to unpack (expected 2)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#3.버전에서는 결과 값이 3개가 나오기 때문에 images를 붙여주면 에러가 나오지 않습니다.</span></span><br><span class="line">images, contours, hierachy  = cv2.findContours(image, mode, method)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-17T15:00:00.000Z" title="2022. 12. 18. 오전 12:00:00">2022-12-18</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-17T15:00:00.000Z" title="2022. 12. 18. 오전 12:00:00">2022-12-18</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">5 minutes read (About 774 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/18/Study_folder/Basic_study/2022-12-18-Pillow/">Pillow(from PIL import Image)</a></h1><div class="content"><h2 id="PIL-이미지-기본적-사용법"><a href="#PIL-이미지-기본적-사용법" class="headerlink" title="PIL 이미지 기본적 사용법"></a>PIL 이미지 기본적 사용법</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#열기 방법1</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;test_file.jpg&#x27;</span>) </span><br><span class="line">img.show()</span><br><span class="line"><span class="comment">#열기 방법2</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">with</span> Image.<span class="built_in">open</span>(<span class="string">&quot;test_file.jpg&quot;</span>) <span class="keyword">as</span> im:</span><br><span class="line">    im.show()</span><br><span class="line"><span class="comment">#정보 확인(가로, 세로, 사이즈)</span></span><br><span class="line">img.width, img.height, img.size</span><br><span class="line"></span><br><span class="line"><span class="comment">#사이즈 변경</span></span><br><span class="line">image.resize((w, h))</span><br></pre></td></tr></table></figure>

<h2 id="Thumbnail-파일-생성하기"><a href="#Thumbnail-파일-생성하기" class="headerlink" title="Thumbnail 파일 생성하기"></a>Thumbnail 파일 생성하기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> glob, os</span><br><span class="line"></span><br><span class="line">size = <span class="number">128</span>, <span class="number">128</span></span><br><span class="line"><span class="comment">#현재 폴더에서 jpg파일들을 썸네일로 만듬</span></span><br><span class="line"><span class="keyword">for</span> infile <span class="keyword">in</span> glob.glob(<span class="string">&quot;*.jpg&quot;</span>): </span><br><span class="line">    file, ext = os.path.splitext(infile)</span><br><span class="line">    im = Image.<span class="built_in">open</span>(infile)</span><br><span class="line">    im.thumbnail(size)</span><br><span class="line">    im.save(file + <span class="string">&quot;.thumbnail&quot;</span>, <span class="string">&quot;JPEG&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#이미지 열기 </span></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;test_file.thumbnail&#x27;</span>) </span><br><span class="line">img.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="이미지-겹치기-사이즈가-같아야함"><a href="#이미지-겹치기-사이즈가-같아야함" class="headerlink" title="이미지 겹치기(사이즈가 같아야함)"></a>이미지 겹치기(사이즈가 같아야함)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 이미지 합성1(겹치기)</span></span><br><span class="line">Image.alpha_composite(img_1, img_2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 합성2(희미하게 만들어서 겹치기 - 새로운 이미지 생성)</span></span><br><span class="line">Image.blend(img_1, img_2, <span class="number">.1</span>)</span><br></pre></td></tr></table></figure>

<h2 id="이미지-증식"><a href="#이미지-증식" class="headerlink" title="이미지 증식"></a>이미지 증식</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 이미지 자르기 : 특정 영역을 오려낸 사본을 만든다. box는 (left, upper, right, lower)로 구성된 튜플이다.</span></span><br><span class="line">Image.crop(box=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># ex) Image.crop((x, y, x+64, y+64)) #튜플형식으로 입력해야됨!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 붙여넣기</span></span><br><span class="line"><span class="comment"># 다른 이미지를 이미지 내 특정 영역이나 위치에 붙여넣는다. mask를 써서 붙이는 이미지에 마스크를 적용할 수 있다. 마스크는 이미지 외에 투명도값을 줄 수 있다.</span></span><br><span class="line">image.paste(im, box=<span class="literal">None</span>, mask=<span class="literal">None</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 회전하기</span></span><br><span class="line"><span class="comment"># 주어진 각도만큼 이미지를 회전한다. 각도는 도(degree)로 주어진다.</span></span><br><span class="line">image.rorate(angle, resample=<span class="number">0</span>, expand=<span class="number">0</span>, center=<span class="literal">None</span>, translate=<span class="literal">None</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#이미지 회전</span></span><br><span class="line">image.transpose(Image.FL) <span class="comment">#좌우 반전</span></span><br><span class="line">image.transpose(Image.FLIP_TOP_BOTTOM) <span class="comment">#상하 반전</span></span><br><span class="line">image.transpose(Image.ROTATE_90) <span class="comment">#90도 회전</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 변형하기</span></span><br><span class="line">image.transform(size, method, data=<span class="literal">None</span>, resample=<span class="number">0</span>, fill=<span class="number">1</span>, fillcolor=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 필터(필터는 ImageFilter 모듈에 정의되어 있다.)</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont, ImageFilter</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;cat_img.jpg&#x27;</span>).resize((<span class="number">300</span>,<span class="number">300</span>))</span><br><span class="line">d = ImageDraw.Draw(img)</span><br><span class="line">d.text((<span class="number">40</span>, <span class="number">10</span>), <span class="string">&#x27;this is BLUR&#x27;</span>, fill=<span class="string">&quot;Red&quot;</span>) <span class="comment">#위치 좌표는 튜플 타입으로 입력</span></span><br><span class="line">img = img.<span class="built_in">filter</span>(ImageFilter.BLUR)</span><br><span class="line">img.save(<span class="string">&#x27;BLUR.jpg&#x27;</span>,<span class="string">&#x27;jpeg&#x27;</span>)</span><br><span class="line">img.show()</span><br></pre></td></tr></table></figure>

<ul>
<li>이미지 필터 종류</li>
</ul>
<table>
<thead>
<tr>
<th align="center">ImageFilter</th>
<th align="center">사진</th>
</tr>
</thead>
<tbody><tr>
<td align="center">BLUR</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271779-48e0a90e-2c93-47d9-97ea-5120bf5a075e.jpg" alt="BLUR"></td>
</tr>
<tr>
<td align="center">CONTOUR</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271786-cdb09c15-8271-48d0-b832-78a41733bae7.jpg" alt="CONTOUR"></td>
</tr>
<tr>
<td align="center">DETAIL</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271795-fe43c4c6-c6a3-4ec5-877f-fad93a902cfe.jpg" alt="DETAIL"></td>
</tr>
<tr>
<td align="center">EDGE_ENHANCE</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271797-992ebed3-a423-4b60-aefa-f3d680006dcc.jpg" alt="EDGE_ENHANCE"></td>
</tr>
<tr>
<td align="center">EMBOSS</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271821-aa74874b-c2c6-40b0-89b4-a0198628935e.jpg" alt="EMBOSS"></td>
</tr>
<tr>
<td align="center">FIND_EDGES</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271814-ea6c1403-8e55-4bf8-8404-219983c4fe60.jpg" alt="FIND_EDGES"></td>
</tr>
<tr>
<td align="center">SHARPEN</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271800-172cfa3d-67b9-4f00-9478-3b88536651b2.jpg" alt="SHARPEN"></td>
</tr>
<tr>
<td align="center">SMOOTH</td>
<td align="center"><img src="https://user-images.githubusercontent.com/111936229/208271836-69cf97db-32e6-4b64-98ad-13c46660cfa7.jpg" alt="SMOOTH"></td>
</tr>
</tbody></table>
<h2 id="이미지-편집-시-필요한-함수들"><a href="#이미지-편집-시-필요한-함수들" class="headerlink" title="이미지 편집 시 필요한 함수들"></a>이미지 편집 시 필요한 함수들</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 밴드 얻기</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&quot;hopper.jpg&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(im.getbands())  <span class="comment"># Returns (&#x27;R&#x27;, &#x27;G&#x27;, &#x27;B&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 바운딩 박스 얻기</span></span><br><span class="line"><span class="comment"># 이미지에서 0이아닌 영역의 범위를 구함</span></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&quot;hopper.jpg&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(im.getbbox())</span><br><span class="line"><span class="comment"># Returns four coordinates in the format (left, upper, right, lower)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 채널 얻기</span></span><br><span class="line">Image.getchannel(channel)</span><br></pre></td></tr></table></figure>


<h2 id="이미지에-텍스트-삽입"><a href="#이미지에-텍스트-삽입" class="headerlink" title="이미지에 텍스트 삽입"></a>이미지에 텍스트 삽입</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&#x27;cat_img.jpg&#x27;</span>).resize((<span class="number">150</span>,<span class="number">150</span>))</span><br><span class="line">ft = ImageFont.truetype(<span class="string">&#x27;Pantherdam Signature Italic.ttf&#x27;</span>, size=<span class="number">20</span>) <span class="comment">#폰트 사용시 파일 지정</span></span><br><span class="line">d = ImageDraw.Draw(im)</span><br><span class="line">d.text((<span class="number">10</span>, <span class="number">10</span>), <span class="string">&#x27;text any text&#x27;</span>, font=ft, fill=<span class="string">&quot;#ff3&quot;</span>) <span class="comment">#위치 좌표는 튜플 타입으로 입력</span></span><br><span class="line"></span><br><span class="line">im.show()</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-17T15:00:00.000Z" title="2022. 12. 18. 오전 12:00:00">2022-12-18</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-17T15:00:00.000Z" title="2022. 12. 18. 오전 12:00:00">2022-12-18</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">a minute read (About 138 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/18/Study_folder/Basic_study/2022-12-19-escape-sequence/">이스케이프 시퀀스(escape sequence) 프린트문에 색상 입히기</a></h1><div class="content"><h2 id="파이썬-프린트문-print-에-색상-입히기"><a href="#파이썬-프린트문-print-에-색상-입히기" class="headerlink" title="파이썬 프린트문(print)에 색상 입히기"></a>파이썬 프린트문(print)에 색상 입히기</h2><ul>
<li><p>BRIGHT_BLACK   &#x3D; ‘\033[90m’</p>
</li>
<li><p>BRIGHT_RED     &#x3D; ‘\033[91m’</p>
</li>
<li><p>BRIGHT_GREEN   &#x3D; ‘\033[92m’</p>
</li>
<li><p>BRIGHT_YELLOW  &#x3D; ‘\033[93m’</p>
</li>
<li><p>BRIGHT_BLUE    &#x3D; ‘\033[94m’</p>
</li>
<li><p>BRIGHT_MAGENTA &#x3D; ‘\033[95m’</p>
</li>
<li><p>BRIGHT_CYAN    &#x3D; ‘\033[96m’</p>
</li>
<li><p>BRIGHT_WHITE   &#x3D; ‘\033[97m’</p>
</li>
<li><p>BRIGHT_END     &#x3D; ‘\033[0m’</p>
</li>
<li><p>Black   &#x3D; ‘\033[30m’</p>
</li>
<li><p>Red     &#x3D; ‘\033[31m’</p>
</li>
<li><p>Green   &#x3D; ‘\033[32m’</p>
</li>
<li><p>Yellow  &#x3D; ‘\033[33m’</p>
</li>
<li><p>Blue    &#x3D; ‘\033[34m’</p>
</li>
<li><p>Magenta &#x3D; ‘\033[35m’</p>
</li>
<li><p>Cyan    &#x3D; ‘\033[36m’</p>
</li>
<li><p>White   &#x3D; ‘\033[37m’</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 이런식으로 사용하면 됩니다.</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\033[93m&#x27;</span> + <span class="string">&#x27;안녕하세요&#x27;</span>) <span class="comment"># 노란색의 &#x27;안녕하세요&#x27; 글자가 출력</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\033[92m&#x27;</span> + <span class="string">&#x27;안녕하세요&#x27;</span>) <span class="comment"># 녹색의 &#x27;안녕하세요&#x27; 글자가 출력</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\033[31m&#x27;</span> + <span class="string">&#x27;안녕&#x27;</span> + <span class="string">&#x27;\033[95m&#x27;</span> + <span class="string">&#x27;하세요&#x27;</span>) <span class="comment"># 빨간색의 &#x27;안녕&#x27;과 &#x27;보라색&#x27;의 하세요 글자가 출력</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-16T15:00:00.000Z" title="2022. 12. 17. 오전 12:00:00">2022-12-17</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-22T15:00:00.000Z" title="2022. 12. 23. 오전 12:00:00">2022-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/Project/">Project</a></span><span class="level-item">9 minutes read (About 1277 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/17/Portfolio/2022-12-17-%08img-cl-swin/">미니프로젝트 part 2</a></h1><div class="content"><h2 id="Classification-using-Swin-Transformer"><a href="#Classification-using-Swin-Transformer" class="headerlink" title="Classification using Swin Transformer"></a>Classification using Swin Transformer</h2><ul>
<li>이번 미니 프로젝트의 목표는</li>
<li>구글 이미지를 웹크롤링을 이용하여 이미지 저장 -&gt; <ul>
<li><code>이미지 분류 모델(Swin Transformer모델을 이용한 파인 튜닝)</code> -&gt;</li>
</ul>
</li>
<li>모델 불러오기 + 구글 이미지를 분류 &amp; 삭제(+정렬)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageFilter</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> einops <span class="keyword">import</span> rearrange <span class="comment">#차원 관리 모듈</span></span><br><span class="line"><span class="keyword">import</span> timm <span class="comment"># 파인튜닝모듈</span></span><br><span class="line"><span class="keyword">from</span> tqdm.notebook <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="comment"># configuration</span></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda:0&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">num_epochs = <span class="number">10</span></span><br><span class="line">lr = <span class="number">0.001</span></span><br><span class="line">batch_size = <span class="number">32</span></span><br><span class="line">num_workers = <span class="number">4</span> <span class="comment"># ipykenel에서는 주석처리를 해야됩니다(멀티프로세싱 오류)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zip파일(archive) 해제하기</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">zip_file=zipfile.ZipFile(<span class="string">&#x27;/content/drive/MyDrive/lesson_data/archive.zip&#x27;</span>)<span class="comment">#파일 이름</span></span><br><span class="line">zip_file.extractall(path=<span class="string">&#x27;/content/data&#x27;</span>)<span class="comment">#압축 해제 경로, default(path=None)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 클래스(타겟) 리스트 만들기</span></span><br><span class="line">class_names = os.listdir(<span class="string">&#x27;./data/train/&#x27;</span>) <span class="comment">#폴더 이름 == 클래스(target) 네임</span></span><br><span class="line">class_names.sort()</span><br><span class="line">class_len = <span class="built_in">len</span>(class_names) </span><br><span class="line"></span><br><span class="line"><span class="comment"># Dataset 클래스 만들기</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sports_Dataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, data_name</span>):</span><br><span class="line">    <span class="comment">#data_name will be set &#x27;train&#x27; or &#x27;valid&#x27;(the folder names)</span></span><br><span class="line">        self.dataname = data_name</span><br><span class="line">        <span class="comment">#train파일 경로리스트 생성     </span></span><br><span class="line">        self.img_path = []</span><br><span class="line">        <span class="comment">#경로가 .jpg 확장자인 파일들을 img_path에 리스트화 시켜줌 </span></span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> class_names:</span><br><span class="line">            self.img_path.append(glob.glob(<span class="string">f&#x27;./data/<span class="subst">&#123;data_name&#125;</span>/<span class="subst">&#123;name&#125;</span>/*jpg&#x27;</span>))</span><br><span class="line">        <span class="comment">#2차원 리스트 -&gt; 1차원 리스트</span></span><br><span class="line">        self.img_path = <span class="built_in">sum</span>(self.img_path, [])</span><br><span class="line">        <span class="comment">#train파일의 labels 생성</span></span><br><span class="line">        self.labels = []</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> self.img_path:</span><br><span class="line">            self.labels.append(class_names.index(path.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">3</span>]))</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#텐서타입으로 변경하는 변수 생성</span></span><br><span class="line">        self.img_transpose = transforms.Compose([transforms.ToTensor()])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        img = Image.<span class="built_in">open</span>(self.img_path[index])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># swin_base_patch4_window7_224모델이 224,224로 트레이닝 된 모델이라서</span></span><br><span class="line">        <span class="comment"># 이미지 보간법을 이용하여 (224,224)사이즈로 변경</span></span><br><span class="line">        <span class="keyword">if</span> img.size != (<span class="number">224</span>,<span class="number">224</span>):</span><br><span class="line">            img = img.resize((<span class="number">224</span>,<span class="number">224</span>),Image.Resampling.BILINEAR)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Data augmentation with PIL when only &#x27;train set&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.dataname == <span class="string">&#x27;train&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> random.uniform(<span class="number">0</span>,<span class="number">1</span>) &lt; <span class="number">0.3</span> <span class="keyword">or</span> img.getbands() == <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">                img = img.convert(<span class="string">&#x27;L&#x27;</span>).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Random crop with size (64,64) from 30%</span></span><br><span class="line">            <span class="keyword">if</span> random.uniform(<span class="number">0</span>,<span class="number">1</span>) &lt; <span class="number">0.3</span> :</span><br><span class="line">                img = img.resize((<span class="number">224</span>+<span class="number">64</span>,<span class="number">224</span>+<span class="number">64</span>), Image.Resampling.BILINEAR)</span><br><span class="line">                x = random.randrange(<span class="number">0</span>,<span class="number">64</span>)</span><br><span class="line">                y = random.randrange(<span class="number">0</span>,<span class="number">64</span>)</span><br><span class="line">                img = img.crop((x,y,x+<span class="number">224</span>, y+<span class="number">224</span>))</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">            <span class="comment"># Random Gaussian blur from 20%</span></span><br><span class="line">            <span class="keyword">if</span> random.uniform(<span class="number">0</span>,<span class="number">1</span>) &lt; <span class="number">0.2</span>:</span><br><span class="line">                img = img.<span class="built_in">filter</span>(ImageFilter.GaussianBlur(random.uniform(<span class="number">0.5</span>,<span class="number">1.2</span>)))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Random flip from 30%</span></span><br><span class="line">            <span class="keyword">if</span> random.uniform(<span class="number">0</span>,<span class="number">1</span>) &lt; <span class="number">0.3</span>:</span><br><span class="line">                img = img.transpose(Image.Transpose.FLIP_LEFT_RIGHT)</span><br><span class="line">        <span class="keyword">else</span> :    </span><br><span class="line">            img = img.convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        lbl = self.labels[index]</span><br><span class="line">        lbl = torch.tensor(lbl)</span><br><span class="line">        img = self.img_transpose(img)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> img, lbl</span><br><span class="line">        <span class="comment">#Sports_Dataset[0] == img, Sports_Dataset[1] == lbl(데이터 사용 방식)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.img_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 이미지 8개 확인 및 데이터셋 클래스 작동 유무 확인(실행하지 않아도 모델링에는 지장은 없음)</span></span><br><span class="line">train_dataset = Sports_Dataset(<span class="string">&#x27;train&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(train_dataset.__len__())</span><br><span class="line">_, ax = plt.subplots(<span class="number">2</span>, <span class="number">4</span>, figsize=(<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    data = train_dataset.__getitem__(random.choice(<span class="built_in">range</span>(train_dataset.__len__())))</span><br><span class="line"></span><br><span class="line">    image = data[<span class="number">0</span>].cpu().detach().numpy().transpose(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>) * <span class="number">255</span></span><br><span class="line">    <span class="comment"># .cpu() == GPU 메모리에 올려져 있는 tensor를 cpu 메모리로 복사하는 method</span></span><br><span class="line">    <span class="comment"># .detach() == Returns a new Tensor</span></span><br><span class="line">    <span class="comment"># detach,cpu 순서는 별로 상관 없다.</span></span><br><span class="line"></span><br><span class="line">    image = image.astype(np.uint32)</span><br><span class="line">    <span class="comment">#uint는 0을포함한 양수로된 정수타입</span></span><br><span class="line"></span><br><span class="line">    label = data[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    ax[i//<span class="number">4</span>][i-(i//<span class="number">4</span>)*<span class="number">4</span>].imshow(image)</span><br><span class="line">    ax[i//<span class="number">4</span>][i-(i//<span class="number">4</span>)*<span class="number">4</span>].set_title(class_names[label])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 학습된 모델 중 swin_base_patch4_window7_224를 사용(파인튜닝)</span></span><br><span class="line">model = timm.create_model(<span class="string">&#x27;swin_base_patch4_window7_224&#x27;</span>, pretrained=<span class="literal">True</span>)</span><br><span class="line">model.head = nn.Sequential(nn.Linear(<span class="number">1024</span>, <span class="number">512</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Dropout(<span class="number">0.3</span>),</span><br><span class="line">            nn.Linear(<span class="number">512</span>, class_len)) </span><br><span class="line"></span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line">criterion = timm.loss.LabelSmoothingCrossEntropy() <span class="comment"># this is better than nn.CrossEntropyLoss</span></span><br><span class="line">criterion = criterion.to(device)</span><br><span class="line"></span><br><span class="line">optimizer = torch.optim.AdamW(model.head.parameters(), lr=lr) <span class="comment"># Setting for transfer learning</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#데이터 정제</span></span><br><span class="line">train_loader = DataLoader(dataset=train_dataset, batch_size=batch_size, shuffle=<span class="literal">True</span>, num_workers=num_workers)</span><br><span class="line"></span><br><span class="line">val_dataset = Sports_Dataset(<span class="string">&#x27;valid&#x27;</span>)</span><br><span class="line">val_loader = DataLoader(dataset=val_dataset, batch_size=<span class="number">1</span>, shuffle=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#training (실행 전에 net폴더가 없으면 생성해주기!)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_lr</span>(<span class="params">optimizer, lr</span>):</span><br><span class="line">    <span class="keyword">for</span> param_group <span class="keyword">in</span> optimizer.param_groups:</span><br><span class="line">        param_group[<span class="string">&#x27;lr&#x27;</span>] = lr</span><br><span class="line"></span><br><span class="line">model.train()</span><br><span class="line"></span><br><span class="line">total_step = <span class="built_in">len</span>(train_loader)</span><br><span class="line">curr_lr = lr</span><br><span class="line">best_score = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    total_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, (images,labels) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(train_loader)):</span><br><span class="line">        images = images.to(device)</span><br><span class="line">        labels = labels.to(device)</span><br><span class="line">        </span><br><span class="line">        g_labels = model(images)</span><br><span class="line">        loss = criterion(g_labels,labels)</span><br><span class="line">        </span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">        </span><br><span class="line">        total_loss += loss.item()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (i+<span class="number">1</span>) % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;batch_size*(i+<span class="number">1</span>)&#125;</span> / <span class="subst">&#123;train_dataset.__len__()&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    score = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, (images, labels) <span class="keyword">in</span> <span class="built_in">enumerate</span>(valid_loader):</span><br><span class="line">        images = images.to(device)</span><br><span class="line">        labels = labels.to(device)</span><br><span class="line">        </span><br><span class="line">        g_labels = model(images)</span><br><span class="line">        score += <span class="built_in">int</span>(torch.<span class="built_in">max</span>(g_labels, <span class="number">1</span>)[<span class="number">1</span>][<span class="number">0</span>] == labels[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Epoch : <span class="subst">&#123;epoch+<span class="number">1</span>&#125;</span>, Loss : <span class="subst">&#123;total_loss/total_step&#125;</span>&#x27;</span>)</span><br><span class="line">    avg = score / <span class="built_in">len</span>(val_dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Accuracy : <span class="subst">&#123;avg :<span class="number">.2</span>f&#125;</span>\n&#x27;</span>)</span><br><span class="line">    model.train()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> best_score &lt; avg:</span><br><span class="line">        best_score = avg</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;./nets&#x27;</span>):</span><br><span class="line">            os.mkdir(<span class="string">&#x27;./nets&#x27;</span>)</span><br><span class="line">        torch.save(model.state_dict(), <span class="string">&#x27;nets/SwinTransformer.ckpt&#x27;</span>) <span class="comment">#net 폴더를 만들어야함</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (epoch+<span class="number">1</span>) %<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        curr_lr = lr * <span class="number">0.8</span></span><br><span class="line">        update_lr(optimizer, curr_lr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#모델 불러오기</span></span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model.load_state_dict(torch.load(<span class="string">&#x27;nets/SwinTransformer.ckpt&#x27;</span>, map_location=device))</span><br><span class="line"></span><br><span class="line">test_dataset = Sports_Dataset(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">test_loader = torch.utils.data.DataLoader(dataset=test_dataset,</span><br><span class="line">                                           batch_size=<span class="number">1</span>,</span><br><span class="line">                                           shuffle=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># accuracy 확인 하기</span></span><br><span class="line">preds = []</span><br><span class="line">gts = []</span><br><span class="line"></span><br><span class="line">score = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i, (images, labels) <span class="keyword">in</span> <span class="built_in">enumerate</span>(test_loader):</span><br><span class="line">    images = images.to(device)</span><br><span class="line">    labels = labels.to(device)</span><br><span class="line"></span><br><span class="line">    g_labels = model(images)</span><br><span class="line">    </span><br><span class="line">    pred = torch.<span class="built_in">max</span>(g_labels, <span class="number">1</span>)[<span class="number">1</span>][<span class="number">0</span>].item()</span><br><span class="line">    preds.append(pred)</span><br><span class="line">    gt = labels[<span class="number">0</span>].item()</span><br><span class="line">    gts.append(gt)</span><br><span class="line">    </span><br><span class="line">    score += <span class="built_in">int</span>(pred == gt)</span><br><span class="line"></span><br><span class="line">avg = score / <span class="built_in">len</span>(val_dataset)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Accuracy: &#123;:.4f&#125;\n&#x27;</span>.<span class="built_in">format</span>(avg))</span><br><span class="line"></span><br><span class="line"><span class="comment">#테스트 데이터 평가(랜덤 8개)</span></span><br><span class="line">test_dataset = Sports_data(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">test_loader = torch.utils.data.DataLoader(dataset=test_dataset,</span><br><span class="line">                                           batch_size=<span class="number">1</span>,</span><br><span class="line">                                           shuffle=<span class="literal">False</span>)</span><br><span class="line">_, ax = plt.subplots(<span class="number">2</span>, <span class="number">4</span>, figsize=(<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    data = test_dataset.__getitem__(np.random.choice(<span class="built_in">range</span>(test_dataset.__len__())))</span><br><span class="line">    </span><br><span class="line">    image = data[<span class="number">0</span>].cpu().detach().numpy().transpose(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>) * <span class="number">255</span></span><br><span class="line">    image = image.astype(np.uint32)</span><br><span class="line">    </span><br><span class="line">    label = data[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    idx = torch.<span class="built_in">max</span>(model(data[<span class="number">0</span>].unsqueeze(<span class="number">0</span>).to(device)), <span class="number">1</span>)[<span class="number">1</span>][<span class="number">0</span>].item()</span><br><span class="line">    </span><br><span class="line">    ax[i//<span class="number">4</span>][i-(i//<span class="number">4</span>)*<span class="number">4</span>].imshow(image)</span><br><span class="line">    ax[i//<span class="number">4</span>][i-(i//<span class="number">4</span>)*<span class="number">4</span>].set_title(<span class="string">&#x27;Predict: &#123;&#125;\nGT: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(class_names[idx], class_names[label]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 녹색: perfect score / 빨간색: imperfect score(어떤 종목을 못맞추었는지 확인하기)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(class_len):</span><br><span class="line">    score_sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        score_sum += <span class="built_in">int</span>(gts[i*<span class="number">5</span>+j] == preds[i*<span class="number">5</span>+j])</span><br><span class="line">    <span class="keyword">if</span> score_sum == <span class="number">5</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\033[92m&#x27;</span> + <span class="string">&#x27;&#123;&#125;: &#123;&#125; / 5&#x27;</span>.<span class="built_in">format</span>(class_names[i], score_sum))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\033[91m&#x27;</span> + <span class="string">&#x27;&#123;&#125;: &#123;&#125; / 5&#x27;</span>.<span class="built_in">format</span>(class_names[i], score_sum))</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-16T15:00:00.000Z" title="2022. 12. 17. 오전 12:00:00">2022-12-17</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-16T15:00:00.000Z" title="2022. 12. 17. 오전 12:00:00">2022-12-17</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">a minute read (About 195 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/17/Study_folder/Basic_study/2022-12-17-list-sum/">파이썬 리스트 합치기(더하기)</a></h1><div class="content"><h2 id="리스트-합치기-a-b"><a href="#리스트-합치기-a-b" class="headerlink" title="리스트 합치기 (a+b)"></a>리스트 합치기 (a+b)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 단순 더하기</span></span><br><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(a + b)</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 3, 2]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#extend 사용하기 - 리스트 a 에 b를 연결 합니다. a 리스트가 변경됨.(단순 더하기)</span></span><br><span class="line">a = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(a.extend(b))</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 3, 2]</span></span><br><span class="line"><span class="comment"># &#x27;+&#x27; 연산이랑 값이 같음</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#append 사용하기 - 리스트 뒤에 값을 추가하기</span></span><br><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(a.append(b))</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2차원 리스트 -&gt; (2-1)차원 리스트 (차원을 1단계만 낮춰줍니다)</span></span><br><span class="line">a = [[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>],[<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],[<span class="number">1</span>,<span class="number">2</span>]]</span><br><span class="line">a = <span class="built_in">sum</span>(a, [])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, 1, 2]</span></span><br><span class="line"><span class="comment"># 만약 3차원리스트 -&gt; 1차원리스트를 원할 경우</span></span><br><span class="line">a = [[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>],[<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],[<span class="number">1</span>,<span class="number">2</span>]]]</span><br><span class="line">a = <span class="built_in">sum</span>(a, [])</span><br><span class="line">a = <span class="built_in">sum</span>(a, [])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, 1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#만약 부분적으로 2차원리스트의 값을 가지고 있다면</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">list1 = [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, [<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;2&#x27;</span>]]</span><br><span class="line">list2 = <span class="built_in">list</span>(itertools.chain.from_iterable(list1))</span><br><span class="line"><span class="built_in">print</span>(list2)</span><br><span class="line"><span class="comment">#[&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;3&#x27;, &#x27;2&#x27;]</span></span><br><span class="line"></span><br><span class="line">list1 = [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, [<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;2&#x27;</span>]]</span><br><span class="line">list2 = <span class="built_in">list</span>(itertools.chain(*list1))</span><br><span class="line"><span class="built_in">print</span>(list2)</span><br><span class="line"><span class="comment">#[&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;3&#x27;, &#x27;2&#x27;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2022-12-14T15:00:00.000Z" title="2022. 12. 15. 오전 12:00:00">2022-12-15</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-12-14T15:00:00.000Z" title="2022. 12. 15. 오전 12:00:00">2022-12-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">2 minutes read (About 288 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/15/Study_folder/Basic_study/2022-12-15-glob/">glob.glob()</a></h1><div class="content"><h2 id="폴더의-모든-목록"><a href="#폴더의-모든-목록" class="headerlink" title="폴더의 모든 목록"></a>폴더의 모든 목록</h2><ul>
<li>globs는 리눅스 운영체제의 명령어 인자로, 파이썬에서도 import glob하여 사용이 가능합니다.</li>
<li>파일을 검색하는 명령어로 잘 사용하면 파일 관리에 매우 유용합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#파일 목록</span></span><br><span class="line">folder : file1.txt, file2.txt, file101.txt, file102.txt, file_a.txt, file_b.txt, file1.jpg, file2.jpg</span><br><span class="line">folder/sub_folder : subfile1.txt, subfile2.txt</span><br><span class="line">folder/sub_folder/sub/sub2 : sub2.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x27;*&#x27;는 임의 길이의 모든 문자열을 의미한다.</span></span><br><span class="line">output = glob.glob(<span class="string">&#x27;folder/*.txt&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line">[<span class="string">&#x27;folder/file1.txt&#x27;</span>, <span class="string">&#x27;folder/file102.txt&#x27;</span>, <span class="string">&#x27;folder/file2.txt&#x27;</span>, <span class="string">&#x27;folder/file_a.txt&#x27;</span>, <span class="string">&#x27;folder/file_b.txt&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x27;?&#x27;는 한자리의 문자를 의미한다. file_a.txt 같은 파일들은 검색하지 못함</span></span><br><span class="line">output = glob.glob(<span class="string">&#x27;folder/file?.*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line">[<span class="string">&#x27;folder/file1.bmp&#x27;</span>, <span class="string">&#x27;folder/file1.txt&#x27;</span>, <span class="string">&#x27;folder/file2.bmp&#x27;</span>, <span class="string">&#x27;folder/file2.txt&#x27;</span>, <span class="string">&#x27;folder/file_a.txt&#x27;</span>, <span class="string">&#x27;folder/file_b.txt&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x27;**&#x27;은 항목을 전체 찾아줍니다.(디렉토리 이름까지 가능)</span></span><br><span class="line">output = glob.glob(<span class="string">&#x27;folder/**xt&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line">[<span class="string">&#x27;folder/file1.txt&#x27;</span>, <span class="string">&#x27;folder/file102.txt&#x27;</span>, <span class="string">&#x27;folder/file2.txt&#x27;</span>, <span class="string">&#x27;folder/file_a.txt&#x27;</span>, <span class="string">&#x27;folder/file_b.txt&#x27;</span>, <span class="string">&#x27;folder/file12.txt]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># &#x27;</span>[]<span class="string">&#x27;를 사용하여 정규표현식으로 사용도 가능합니다.</span></span><br><span class="line"><span class="string">output = glob.glob(&#x27;</span>folder/file[<span class="number">0</span>-<span class="number">9</span>]*.txt<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">print(output)</span></span><br><span class="line"><span class="string">[&#x27;</span>folder/file1.txt<span class="string">&#x27;, &#x27;</span>folder/file102.txt<span class="string">&#x27;, &#x27;</span>folder/file2.txt<span class="string">&#x27;]</span></span><br></pre></td></tr></table></figure>

</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/4/">Previous</a></div><div class="pagination-next"><a href="/page/6/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/4/">4</a></li><li><a class="pagination-link is-current" href="/page/5/">5</a></li><li><a class="pagination-link" href="/page/6/">6</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/10/">10</a></li></ul></nav></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="Inhwan Cho"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Inhwan Cho</p><p class="is-size-6 is-block">Inhwan&#039;s Digital Space</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul in Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">98</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">12</p></a></div></div></nav><div class="level"><a class="level-item button is-info is-outlined is-rounded" href="/" target="_self" rel="noopener">Home</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/InhwanCho"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Blog/"><span class="level-start"><span class="level-item">Blog</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Colab/"><span class="level-start"><span class="level-item">Colab</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Command/"><span class="level-start"><span class="level-item">Command</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Errors/"><span class="level-start"><span class="level-item">Errors</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Mac/"><span class="level-start"><span class="level-item">Mac</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/OpenCV/"><span class="level-start"><span class="level-item">OpenCV</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Portfolio/"><span class="level-start"><span class="level-item">Portfolio</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Project/"><span class="level-start"><span class="level-item">Project</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Review/"><span class="level-start"><span class="level-item">Review</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Samples/"><span class="level-start"><span class="level-item">Samples</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Study/"><span class="level-start"><span class="level-item">Study</span></span><span class="level-end"><span class="level-item tag">60</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2023-01-18T06:23:12.874Z">2023-01-18</time></p><p class="title"><a href="/2023/01/18/Study_folder/OpneCV/2023-01-18-haarscascade/">OpenCV 얼굴, 눈 등 특정 객체 검출</a></p><p class="categories"><a href="/categories/OpenCV/">OpenCV</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-01-18T05:11:30.071Z">2023-01-18</time></p><p class="title"><a href="/2023/01/18/Study_folder/OpneCV/2023-01-18-contour/">OpenCV 윤곽선 검출</a></p><p class="categories"><a href="/categories/OpenCV/">OpenCV</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-01-17T13:20:05.900Z">2023-01-17</time></p><p class="title"><a href="/2023/01/17/Study_folder/OpneCV/2023-01-18-opencv/">OpenCV 여러장의 이미지를 한장으로 출력하는 방법</a></p><p class="categories"><a href="/categories/OpenCV/">OpenCV</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-01-15T15:00:00.000Z">2023-01-16</time></p><p class="title"><a href="/2023/01/16/Blogs_folder/2023-01-16-customizeing/">Icarus 테마 커스터마이징</a></p><p class="categories"><a href="/categories/Errors/">Errors</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-01-14T15:00:00.000Z">2023-01-15</time></p><p class="title"><a href="/2023/01/15/Study_folder/OpneCV/2023-01-15-webcam-in-colab/">OpenCV 코랩에서 웹캠 사용하기</a></p><p class="categories"><a href="/categories/OpenCV/">OpenCV</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">25</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/yo_img.jpg" alt="Inhwan&#039;s Digital Space" height="28"></a><p class="is-size-7"><span>&copy; 2023 InhwanCho</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/InhwanCho"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>